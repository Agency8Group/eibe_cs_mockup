<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>고객센터 트리맵</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Segoe UI', 'Malgun Gothic', '맑은 고딕', Arial, sans-serif;
            padding: 40px 20px;
            max-width: 1400px;
            margin: 0 auto;
            background: #f5f5f7;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            color: #1d1d1f;
            font-weight: 600;
            letter-spacing: -0.5px;
            font-size: 32px;
        }

        .version-info {
            text-align: center;
            font-size: 13px;
            color: #86868b;
            margin-bottom: 40px;
            font-weight: 400;
        }

        .form-container {
            display: flex;
            gap: 20px;
            align-items: flex-end;
            flex-wrap: wrap;
            background: #ffffff;
            padding: 30px;
            border-radius: 18px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);
            border: 1px solid rgba(0, 0, 0, 0.04);
        }

        .form-group {
            flex: 1;
            min-width: 200px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #1d1d1f;
            font-size: 13px;
            letter-spacing: -0.1px;
            transition: color 0.2s ease;
        }

        .form-group select {
            width: 100%;
            padding: 14px 16px;
            font-size: 15px;
            border: 1px solid #d2d2d7;
            border-radius: 12px;
            background: #ffffff;
            color: #1d1d1f;
            cursor: pointer;
            outline: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23686868' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 12px;
            padding-right: 40px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .form-group select:hover {
            border-color: #a1a1a6;
            background-color: #fafafa;
        }

        .form-group select:focus {
            border-color: #007aff;
            box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.1);
            background-color: #ffffff;
        }

        .form-group select:disabled {
            background-color: #f5f5f7;
            cursor: not-allowed;
            opacity: 0.5;
            border-color: #e5e5e7;
        }

        .form-group select option {
            padding: 12px;
            background: #ffffff;
            color: #1d1d1f;
        }

        .button-container {
            text-align: center;
            margin: 30px 0;
        }

        .treemap-btn {
            background: #007aff;
            color: white;
            border: none;
            padding: 14px 32px;
            font-size: 15px;
            font-weight: 500;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 122, 255, 0.2);
        }

        .treemap-btn:hover {
            background: #0051d5;
            box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
        }

        .treemap-btn:active {
            transform: scale(0.98);
            box-shadow: 0 1px 4px rgba(0, 122, 255, 0.2);
        }

        .treemap-container {
            display: none;
            background: #ffffff;
            padding: 40px;
            border-radius: 18px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);
            border: 1px solid rgba(0, 0, 0, 0.04);
            margin-top: 30px;
            animation: fadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .treemap-container.show {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .treemap-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e5e5e7;
        }

        .treemap-title {
            font-size: 24px;
            font-weight: 600;
            color: #1d1d1f;
            margin: 0;
            letter-spacing: -0.3px;
        }

        .close-btn {
            background: #ff3b30;
            color: white;
            border: none;
            padding: 8px 16px;
            font-size: 13px;
            font-weight: 500;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .close-btn:hover {
            background: #d70015;
        }

        .close-btn:active {
            transform: scale(0.96);
        }

        .brand-section {
            margin-bottom: 50px;
        }

        .brand-title {
            font-size: 20px;
            font-weight: 600;
            color: #1d1d1f;
            margin-bottom: 20px;
            padding: 14px 20px;
            background: #f5f5f7;
            border-radius: 12px;
            letter-spacing: -0.2px;
        }

        .category-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .category-table thead {
            background: #f5f5f7;
            color: #1d1d1f;
        }

        .category-table th {
            padding: 14px 16px;
            text-align: left;
            font-weight: 600;
            letter-spacing: -0.1px;
            font-size: 13px;
            text-transform: uppercase;
            color: #86868b;
        }

        .category-table td {
            padding: 12px 16px;
            border-bottom: 1px solid #e5e5e7;
            color: #1d1d1f;
        }

        .category-table tbody tr {
            transition: background 0.15s ease;
        }

        .category-table tbody tr:hover {
            background: #fafafa;
        }

        .category-table tbody tr:last-child td {
            border-bottom: none;
        }

        .middle-category {
            font-weight: 600;
            color: #007aff;
            background: #f0f7ff;
        }

        .sub-category {
            padding-left: 30px !important;
            color: #86868b;
        }

        .product-name {
            color: #86868b;
            font-size: 13px;
        }

        @media (max-width: 768px) {
            .form-container {
                flex-direction: column;
                align-items: stretch;
            }

            .form-group {
                min-width: 100%;
            }

            .treemap-container {
                padding: 20px;
            }

            .category-table {
                font-size: 12px;
            }

            .category-table th,
            .category-table td {
                padding: 8px 10px;
            }
        }
    </style>
</head>
<body>
    <h1>문의분류v0.0.6</h1>
    <div class="version-info">SKU 최신화 2025-12-03 기준</div>

    <div class="button-container">
        <button class="treemap-btn" onclick="toggleTreemap()">전체 트리맵 보기</button>
    </div>

    <div class="form-container">
        <!-- 1단계: 대분류 선택 (브랜드) -->
        <div class="form-group">
            <label for="mainCategory">대분류</label>
            <select id="mainCategory" onchange="onMainCategoryChange()">
                <option value="">선택하세요</option>
                <option value="dreame">드리미(dreame)</option>
                <option value="aptamil">압타밀(Aptamil)</option>
                <option value="fortimel">포티밀(Fortimel)</option>
                <option value="laylayt">레이레이(laylayt)</option>
            </select>
        </div>

        <!-- 2단계: 중분류 선택 -->
        <div class="form-group" id="middleCategoryGroup">
            <label for="middleCategory">중분류</label>
            <select id="middleCategory" onchange="onMiddleCategoryChange()" disabled>
                <option value="">선택하세요</option>
            </select>
        </div>

        <!-- 3단계: 소분류 선택 -->
        <div class="form-group" id="subCategoryGroup">
            <label for="subCategory">소분류</label>
            <select id="subCategory" onchange="onSubCategoryChange()" disabled>
                <option value="">선택하세요</option>
            </select>
        </div>

        <!-- 4단계: 제품명 선택 (대분류에 따라 변경) -->
        <div class="form-group" id="productNameGroup">
            <label for="productName">제품명</label>
            <select id="productName" onchange="onProductNameChange()" disabled>
                <option value="">선택하세요</option>
            </select>
        </div>
    </div>

    <div class="treemap-container" id="treemapContainer">
        <div class="treemap-header">
            <h2 class="treemap-title">전체 문의분류 트리맵</h2>
            <button class="close-btn" onclick="toggleTreemap()">닫기</button>
        </div>
        <div id="treemapContent"></div>
    </div>

    <script>
        // 데이터 구조: 대분류(브랜드) > 중분류 > 소분류
        const categoryData = {
            dreame: {
                '배송문의': ['배송 지연', '오배송', '배송지 오기입', '수취인 부재', '설치 일정 변경', '송장 미등록', '기타'],
                '교환요청': ['제품 오염/이염', '제품 파손', '구성품 누락', '색상/옵션 오류', '초기불량', '클레임 사은품 지급', '기타'],
                '반품요청': ['단순 변심', '제품 오염/이염', '제품 파손', '오주문', '반품 후 환불 지연', '클레임 사은품 지급', '기타'],
                'AS접수': ['작동 불량', '부품 누락', '재포장 요청', '기타'],
                '사용문의': ['어플사용/연동', '제품사용', '소모품사용', '기타'],
                '기타문의': ['사은품 문의', 'CS 친절도', '기타']
            },
            aptamil: {
                '배송문의': ['배송 지연', '오배송', '배송지 오기입', '수취인 부재', '송장 미등록', '기타'],
                '직구관련 문의 (통관)': ['기타'],
                '교환요청': ['제품 오염/이염', '제품 파손', '이물질', '수량 오류', '기타'],
                '반품요청': ['단순 변심', '제품 오염/이염', '제품 파손', '유통기한 문제', '부분환불', '기타'],
                '환불요청': ['반품 후 환불 지연', '기타'],
                '기타문의': ['섭취관련 문의', '제품 성분 문의', '이벤트/사은품', '기타']
            },
            fortimel: {
                '배송문의': ['배송 지연', '오배송', '배송지 오기입', '수취인 부재', '송장 미등록', '기타'],
                '직구관련 문의 (통관)': ['기타'],
                '교환요청': ['제품 오염/이염', '제품 파손', '이물질', '수량 오류', '기타'],
                '반품요청': ['단순 변심', '제품 오염/이염', '제품 파손', '유통기한 문제', '부분환불', '기타'],
                '환불요청': ['반품 후 환불 지연', '기타'],
                '기타문의': ['섭취관련 문의', '제품 성분 문의', '이벤트/사은품', '기타']
            },
            laylayt: {
                '배송문의': ['배송 지연', '오배송', '배송지 오기입', '수취인 부재', '설치 일정 변경', '송장 미등록', '기타'],
                '교환요청': ['제품 오염/이염', '제품 파손', '구성품 누락', '색상/옵션 오류', '초기불량', '매트리스 결함', '프레임 불안정', '클레임 사은품 지급', '기타'],
                '반품요청': ['단순 변심', '제품 오염/이염', '제품 파손', '오주문', '사이즈 불일치', '반품 후 환불 지연', '클레임 사은품 지급', '기타'],
                'AS접수': ['조립 불량', '부품 누락', '프레임 불안정', '매트리스 결함', '재포장 요청', '기타'],
                '사용문의': ['침대 사용법', '매트리스 관리', '조립 방법', '제품 사양 문의', '기타'],
                '기타문의': ['사은품 문의', 'CS 친절도', '기타']
            }
        };

        // 제품명 데이터: 대분류에 따라 다른 제품명
        const productData = {
            dreame: [
                '(본품) L10S Ultra',
                '(본품) L10 Prime',
                '(본품) L20 Ultra',
                '(본품) L10s Pro Ultra Heat',
                '(본품) X40 Ultra',
                '(본품) X50 Ultra (White)',
                '(본품) X50 Ultra (Black)',
                '(본품) X50 Master',
                '(본품) X50s Pro Ultra (White)',
                '(본품) X50s Pro Master',
                '(본품) X50s Pro Ultra (Black)',
                '(본품) LIVO',
                '(본품) Matrix10 Ultra (white)',
                '(본품) Matrix10 Ultra (black)',
                '(본품) Aqua10 Ultra',
                '(본품) Aqua10 Master',
                '(본품) X1 air',
                '(본품) X1 slim',
                'Heat/L20 사이드 브러쉬',
                'X40 Ultra 3중컷 브러쉬',
                'X40 Ultra 악세사리 키트',
                'X40/L10s 히트 필터',
                'Heat/L20 메인 브러쉬 커버',
                'X40/Heat/L20/L10s Ultra 메인 브러쉬',
                'Matrix/X50s/X50 필터',
                'X50s/X50 메인 브러쉬 (듀오 브러쉬)',
                'X50 Ultra 물얼룩 방지필터',
                'X50 Ultra/X50 Master 브러쉬 커버',
                'X50 Ultra 악세사리 키트',
                'X50/X40 사이드 로봇 브러쉬',
                'X50/X40/Heat/L20/L10s 먼지봉투',
                'X50/X40/Heat/L20/L10/L10s 물걸레 패드',
                'X50s 보온 물걸레 패드',
                '드리미 경사로',
                'Heat/X40/X50/X50s 직배수 키트',
                'X50s/X50/X40/Heat/W10 Pro 바닥 클리너',
                '리보 활성탄 필터',
                'W10 Pro 필터',
                'W10 Pro 메인 브러쉬',
                'W10 Pro 메인 브러쉬 (커버)',
                'W10 Pro 물걸레 패드 (전용)',
                'W10 Pro 방습 패드',
                'W10 Pro 사이드 브러쉬',
                'W10 Pro 악세사리 키트',
                '청소솔',
                'L10s Ultra 필터',
                'L10s Ultra 메인 브러쉬 (커버)',
                'L10s Ultra 바닥 클리너 3개입',
                'L10s Ultra 사이드 브러쉬',
                'L10s Ultra 악세사리 키트',
                'L10 Prime 악세사리 키트',
                'L20 Ultra 필터',
                'L20 Ultra 바닥 클리너',
                'L20 Ultra 악세사리 키트',
                'L20 Ultra 직배수 키트',
                'L10s Pro Ultra Heat 악세사리 키트',
                'Aqua10 Ultra 악세사리 키트',
                'Aqua10 Ultra 직배수 키트',
                'Aqua10 Ultra 필터',
                'Aqua10 Ultra 브러쉬 커버',
                'Aqua10 Ultra 롤러형 물걸레',
                'Matrix10 Ultra 악세사리 키트',
                'Matrix10 Ultra 직배수 키트',
                '기름때 전용 물걸레 패드',
                '흡수형 물걸레 패드',
                '리보 건조통',
                'H12 필터',
                '반려동물 전용 바닥 클리너'
            ],
            aptamil: [
                '프로누트라 1단계',
                '프로누트라 2단계',
                '프로누트라 3단계',
                '프로푸트라 1단계',
                '프로푸트라 2단계',
                '프로푸트라 3단계',
                '뉴트리시아 네오케이트',
                '뉴트리시아 듀오칼',
                '뉴트리시아 인파트리니',
                '뉴트리시아 압타밀 펩티 시네오',
                '뉴트리시아 엘리멘탈 028 엑스트라 오렌지 100G',
                '뉴트리시아 피케이 에이드4 500G',
                '뉴트리시아 티와이알 아나믹스 400G',
                '뉴트리시아 엔케이에이치 아나믹스 400G',
                '뉴트리시아 로렌조 오일 500ML',
                '뉴트리시아 지에이1 아나믹스 인펀트 400g',
                '뉴트리시아 지에이1 아나믹스 주니어 400g',
                '뉴트리시아 엠에스유디 아나믹스 주니어 400g',
                '뉴트리시아 엠에스유디 맥사멈 500g',
                '뉴트리시아 로카솔 400g',
                '뉴트리시아 베이직 에프 300g',
                '뉴트리시아 엘리멘탈 028 엑스트라 바나나 100G',
                '뉴트리시아 엘리멘탈 028 엑스트라 무맛 100G',
                '(직구) 프로누트라 프레 Pronutra Pre',
                '(직구) 프로누트라 1단계 Pronutra 1',
                '(직구) 프로누트라 2단계 Pronutra 2',
                '(직구) 프로누트라 3단계 Pronutra 3',
                '(직구) 프로누트라 VP 1단계 Pronutra VP 1',
                '(직구) 프로누트라 VP 2단계 Pronutra VP 2',
                '(직구) 프로푸트라 프레 Profutura Pre',
                '(직구) 프로푸트라 1단계 Profutura 1',
                '(직구) 프로푸트라 1단계 Profutura 2',
                '(직구) TAB IF',
                '(직구) TAB FO',
                '(직구) 프로푸트라 킨더 1단계 Profutura Kinder 1',
                '(직구) 프로푸트라 킨더 1단계 Profutura Kinder 2',
                '(직구) AR',
                '(직구) Comfort',
                '(직구) 3PF 1+IF',
                '(직구) 3PF 2+FO',
                '(직구) 3PN2+FO',
                '(직구) 3PN PRE +IF',
                '(직구) 3PF PRE +IF',
                '(직구) 3PN1+IF'
            ],
            fortimel: [
                '포티멜 프로틴 바닐라향',
                '(직구) 포티멜 컴팩트 프로틴 모카 Fortimel Compact Protein Mocha',
                '(직구) 포티멜 컴팩트 프로틴 뉴트럴(무맛) Fortimel Compact Protein Neu',
                '(직구) 포티멜 컴팩트 프로틴 쿨 레드프루트맛 Fortimel Compact Protein Cool Redfruit',
                '(직구) 포티멜 컴팩트 프로틴 핫 진저맛 Fortimel Compact Protein Hot Ginger'
            ],
            laylayt: [
                '(매트리스) 레이레이 LAYZ-1 픽셀 스프링 매트리스',
                '(매트리스) 레이레이 LAYZ-1 픽셀 스프링 하이브리드 매트리스',
                '(매트리스) 레이레이 LAYZ-2 픽셀 스프링 매트리스',
                '(매트리스) 레이레이 LAYZ-2 픽셀 스프링 하이브리드 매트리스',
                '(매트리스) 레이레이 LAYZ-3 픽셀 스프링 매트리스',
                '(매트리스) 레이레이 LAYZ-3 픽셀 스프링 하이브리드 매트리스',
                '(토퍼) 레이레이 T5 메모리폼 토퍼',
                '(토퍼) 레이레이 T10 메모리폼 토퍼',
                '(필로우) 레이레이 스프링 필로우',
                '(필로우) 레이레이 메모리폼 필로우',
                '(침구) 레이레이 매트리스 커버',
                '(침구) 레이레이 침대 패드'
            ]
        };

        // 대분류 변경 시
        function onMainCategoryChange() {
            const mainCategory = document.getElementById('mainCategory').value;
            const middleCategorySelect = document.getElementById('middleCategory');
            const subCategorySelect = document.getElementById('subCategory');
            const productNameSelect = document.getElementById('productName');

            // 초기화
            middleCategorySelect.innerHTML = '<option value="">선택하세요</option>';
            subCategorySelect.innerHTML = '<option value="">선택하세요</option>';
            productNameSelect.innerHTML = '<option value="">선택하세요</option>';
            
            // 비활성화
            middleCategorySelect.disabled = true;
            subCategorySelect.disabled = true;
            productNameSelect.disabled = true;

            if (mainCategory) {
                // 중분류 옵션 추가
                if (categoryData[mainCategory]) {
                    const middleCategories = Object.keys(categoryData[mainCategory]);
                    middleCategories.forEach(category => {
                        const option = document.createElement('option');
                        option.value = category;
                        option.textContent = category;
                        middleCategorySelect.appendChild(option);
                    });
                    middleCategorySelect.disabled = false;
                }

                // 제품명 옵션 추가
                if (productData[mainCategory]) {
                    productData[mainCategory].forEach(product => {
                        const option = document.createElement('option');
                        option.value = product;
                        option.textContent = product;
                        productNameSelect.appendChild(option);
                    });
                    productNameSelect.disabled = false;
                }
            }
        }

        // 중분류 변경 시
        function onMiddleCategoryChange() {
            const mainCategory = document.getElementById('mainCategory').value;
            const middleCategory = document.getElementById('middleCategory').value;
            const subCategorySelect = document.getElementById('subCategory');

            // 초기화
            subCategorySelect.innerHTML = '<option value="">선택하세요</option>';
            subCategorySelect.disabled = true;

            if (mainCategory && middleCategory && categoryData[mainCategory] && categoryData[mainCategory][middleCategory]) {
                // 소분류 옵션 추가
                const subCategories = categoryData[mainCategory][middleCategory];
                subCategories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    subCategorySelect.appendChild(option);
                });
                subCategorySelect.disabled = false;
            }
        }

        // 소분류 변경 시
        function onSubCategoryChange() {
            const mainCategory = document.getElementById('mainCategory').value;
            const middleCategory = document.getElementById('middleCategory').value;
            const subCategory = document.getElementById('subCategory').value;
            
            // 선택된 값들을 콘솔에 출력 (실제 사용 시 여기에 로직 추가)
            if (mainCategory && middleCategory && subCategory) {
                console.log('선택된 분류:', mainCategory, '>', middleCategory, '>', subCategory);
            }
        }

        // 제품명 변경 시 (별개 로직)
        function onProductNameChange() {
            const productName = document.getElementById('productName').value;
            
            // 선택된 제품명을 콘솔에 출력 (실제 사용 시 여기에 로직 추가)
            if (productName) {
                console.log('선택된 제품명:', productName);
            }
        }

        // 트리맵 토글
        function toggleTreemap() {
            const container = document.getElementById('treemapContainer');
            container.classList.toggle('show');
            
            if (container.classList.contains('show')) {
                renderTreemap();
            }
        }

        // 트리맵 렌더링
        function renderTreemap() {
            const content = document.getElementById('treemapContent');
            let html = '';

            // 각 브랜드별로 트리맵 생성
            Object.keys(categoryData).forEach(brand => {
                const brandNameMap = {
                    dreame: '드리미(dreame)',
                    aptamil: '압타밀(Aptamil)',
                    fortimel: '포티밀(Fortimel)',
                    laylayt: '레이레이(laylayt)'
                };
                const brandName = brandNameMap[brand] || brand;
                const products = productData[brand];
                
                html += `<div class="brand-section">`;
                html += `<div class="brand-title">${brandName}</div>`;
                html += `<table class="category-table">`;
                html += `<thead><tr><th style="width: 15%;">대분류</th><th style="width: 20%;">중분류</th><th style="width: 40%;">소분류</th><th style="width: 25%;">제품명</th></tr></thead>`;
                html += `<tbody>`;

                // 중분류별로 순회
                Object.keys(categoryData[brand]).forEach(middleCategory => {
                    const subCategories = categoryData[brand][middleCategory];
                    const rowspan = subCategories.length;
                    
                    subCategories.forEach((subCategory, index) => {
                        html += `<tr>`;
                        
                        // 첫 번째 행에만 대분류와 중분류 표시
                        if (index === 0) {
                            html += `<td rowspan="${rowspan}" style="font-weight: 600; color: #2c3e50; vertical-align: top; padding-top: 16px;">${brandName}</td>`;
                            html += `<td rowspan="${rowspan}" class="middle-category" style="vertical-align: top; padding-top: 16px;">${middleCategory}</td>`;
                        }
                        
                        html += `<td class="sub-category">${subCategory}</td>`;
                        
                        // 첫 번째 행에만 제품명 표시
                        if (index === 0) {
                            html += `<td rowspan="${rowspan}" class="product-name" style="vertical-align: top; padding-top: 16px;">${products.join(', ')}</td>`;
                        }
                        
                        html += `</tr>`;
                    });
                });

                html += `</tbody>`;
                html += `</table>`;
                html += `</div>`;
            });

            content.innerHTML = html;
        }
    </script>
</body>
</html>
